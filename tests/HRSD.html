<html>

<head>
	<meta name="author" content="pysdp" />
	<meta name="generator" content="notepad++"/>
	<script src="../js/jquery-latest.js"></script>
	<script src="../js/md5-min.js"></script>
	<link rel="stylesheet" type="text/css" href="./css/styles.css" />
	<link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>

<style type="text/css">

#header, #articles, #formulario, #informe {
	float: center;
	margin-top:40px;
	margin-left:auto;
	margin-right:auto;
	margin-bottom:20px;
	padding: 1ex 2ex 1ex 1ex;
	max-width: 1000px;
	min-width: 600px;
	}
#articles {
	margin-bottom: 300px ;  
	}

#articles, #formulario, #informe {
	border: 1px solid gray;
	border-radius: 5px;
	margin-bottom: 100px;
	}
#nombre, #edad, #sexo, #fecha {	
	float:right; margin-left:10px;
	margin-right:10px;
	}
div.opc {
	width: 100%;
	height: 40px;
	}
	
input.opc{
	background-color: transparent;
	border-style: solid;
	border-width: 0px 0px 1px 0px;
	border-color: gray;
	color: gray;
	}

#informe {
	display: none;
	}

body {
	background: white;
	}

h1, h2 {
	font-family: 'Roboto Slab', serif;
	color:black;
	}

div.m6r	{
	margin: auto auto auto auto;
	float:center;
	padding: 10px 10px 10px 10px;
	text-align: center;
	}
div.mpeq6 {
	width: 190px;
	height: 110px;
	position: relative;
	float: left;
	margin: 10px 0px 10px 0px;
	}

div.m8r	{
	margin: auto auto auto auto;
	float:center;
	padding: 10px 10px 10px 10px;
	text-align: center;
	}
div.mpeq8 {
	width: 160px;
	height: 110px;
	position: relative;
	float: left;
	margin: 10px 0px 10px 0px;
	}

div.error {
	font: 90%  'Raleway', arial, sans-serif, helvetica, verdana;
	color: red;
	}	

div.clear {
	clear: both;
	}

/* ##### COLORES ##### */
#header {
	background: none;
	 }
#contenidos {
	color: black;
	background: none;
	}
#contenidos a:hover, #formulario a:hover, #informe a:hover {
	color:rgba(54, 54, 54, 0.7);
	}
#contenidos a, #formulario a, #informe a {
	color: orange;
	}

.boton, .boton a {
	background: gray;
	color: white;
	}
#articles, #formulario, #informe {
	color: black;
	}
#aboutme {
	background: none;
	}

.footBar { 
	color: orange;
	background-color: white; 
	}

.boxtst{
	width: 100px;
	height: 100px;
	position: relative;
	float: left;
	margin: 15px 15px 15px 15px;
	border: 1px solid orange;
	border-radius: 5px;
	padding: 1ex 2ex 1ex 1ex;
	text-align: center;
	font-family: "Raleway", cursive;
	font-size: 15pt;
	color: orange;
	background-color: rgba(54, 54, 54, 0.9);
	
	}
.boxtst:hover{
	color: white;
	background-color: orange;
	border: 1px solid orange;
	}
.mbig{
	height: 200px;
	margin: 10px 5px 10px 0px;
	border: 1px solid black;
	border-radius: 5px;
	text-align: center;
	vertical-align: middle;
	font-family: "Raleway", cursive;
	font-size: 15pt;
	color: black;
	background-color: white;
}
.opcion {
	width: 49%;
	min-height: 120px;
	position: relative;
	float: left;
	margin: 10px 5px 10px 0px;
	border: 1px solid black;
	border-radius: 5px;
	text-align: center;
	vertical-align: middle;
	font-family: "Raleway", cursive;
	font-size: 15pt;
	color: black;
	background-color: white;
	}
.opcion:hover {
	color: white;
	background-color: rgba(54, 54, 54, 0.9);
 	}
</style>
<script>
data = 'El nombre'
lastTimestamp = Math.round(+new Date());
loadedMatrix = 0;
selectedSet = "A";

type6 = ["A", "B"]
answ = []

function anota(valor){
	data = data + ","+ (valor+1) + "," + (Math.round(+new Date())-lastTimestamp).toString();
	answ.push(valor)
	lastTimestamp = Math.round(+new Date());
	contenido = document.createElement('texto');
	contenido.innerHTML = "<b>" + areas[loadedMatrix] + "</b><p>"+ opciones[loadedMatrix][valor][1] + "</p><br/>";
	document.getElementById("informe").appendChild(contenido);
	console.log(data);
	document.getElementById("matrices").innerHTML = "";
	loadNext();
	}
function sum(a, b) { 
	return (a + b) 
}
function matriz6r(num) {
	respuestas = ""
	emociones = [
			[
			]
		]
	areas = ["",
		"1. Humor deprimido (tristeza, depresión, desamparo, inutilidad)",
		"2. Sensación de culpabilidad",
		"3. Suicidio",
		"4. Insomnio precoz",	
		"5. Insomnio medio",
		"6. Insomnio tardío",
		"7. Trabajo y actividades",
		"8. Inhibición (lentitud del pensamiento y de la palabra, facultad de concentración empeorada, actividad motora disminuída)",
		"9. Agitación",
		"10. Ansiedad psíquica",
		"11. Ansiedad somática. Signos fisiológicos concomitantes a la ansiedad, tales como: gastrointestinales (boca seca, flatulencia, indigestión, diarrea, retortijones, eructos,), cardiovasculares (palpitaciones, cefalgias), respiratorios (hiperventilación, suspiros), frecuencia urinaria, sudoración.",
		"12. Síntomas somáticos gastrointestinales",
		"13. Síntomas somáticos en general",
		"14. Síntomas genitales, como pérdida de la líbido o trastornos menstruales",
		"15. Hipocondría",
		"16. Pérdida de peso (Completar A o B)",
		"17. 'Insigh' (Conciencia de sí mismo)",
		"18. Variación diurna (Indicar si los síntomas son más severos por la mañana o por la tarde, rodeando M o T",
		"19. Despersonalización y falta de realidad",
		"20. Síntomas paranoides",
		"21. Síntomas obsesivos y compulsivos",
		"22. Otros síntomas (especificar)"
		]
	opciones = [[],
	[
		[0, "Ausente"],
		[1, "Estas sensaciones se indican solamente al ser preguntado"],
		[2, "Estas sensaciones se relatan oral o espontáneamente"],
		[3, "Sensaciones no comunicadas verbalmente, es decir por la expresión facial, la postura, la voz y la tendencia al llanto."],
		[4, "El paciente manifiesta estas sensaciones en su comunicación verbal y no verbal de forma espontanea."]
	],
	[
		[0, "Ausente"],
		[1, "Se culpa a sí mismo, cree haber decepcionado a la gente"],
		[2, "Ideas de culpabilidad, o meditación sobre errores pasados p malas acciones"],
		[3, "La enfermedad actual es un castigo. Ideas delirantes de culpabilidad"],
		[4, "Oye voces acusatorias o de denuncia y/o experimenta alucinaciones visuales amenazadoras"]
	],
	[
		[0, "Ausente"],
		[1, "Le parece que la vida no vale la pena vivirla"],
		[2, "Desearía estar muerto o tiene pensamientos sobre la posibilidad de morirse"],
		[3, "Ideas de suicidio o amenazas"],
		[4, "Intentos de suicidio (4 para cualquier intento serio)"]
	],
	[
		[0, "No tiene dificultad para dormirse"],
		[1, "Se queja de dificultades ocasionales para dormirse, por ejemplo más de media hora"],
		[2, "Se queja de dificultades para dormirse cada noche"]
	],
	[
		[0, "No hay dificultad"],
		[1, "El paciente se queja de estar inquieto durante la noche"],
		[2, "Está despierto durante la noche (cualquier ocasión de levantarse de la cama se clasifica 2, excepto por motivos de evacuar)."]
	],
	[
		[0, "No hay dificultad"],
		[1, "Se despierta a primeras horas de la madrugada, pero se vuelve a dormir"],
		[2, "No puede volver a dormirse si se levanta de la cama"]
	],
	[
		[0, "No hay dificultad"],
		[1, "Ideas y sentimientos de incapacidad. Fatiga o debilidad relacionadas con la actividad, trabajo o aficiones"],
		[2, "Pérdida de interés de la actividad, aficiones o trabajo, manifestada directamente por el enfermo o indirectamente por desatención, indecisión, y vacilación (siente que debe de esforzarse en su trabajo o actividades)."],
		[3, "Disminución del tiempo dedicado a actividades o descenso de la productividad. En el hospital, clasificar en 3 si el paciente no dedica por lo menos 3 horas al día a actividades relacionadas exclusivamente con las pequeñas tareas del hospital o aficiones"],
		[4, "Dejó de trabajar por la presente enfermedad. En el hospital, clasificar en 4 si el paciente no se compromete en otras actividades más que a las pequeñas tareas, o si no puede realizar estas sin ayuda."]
	],
	[
		[0, "Palabra y pensamiento normales"],
		[1, "Ligero retraso en el dialogo"],
		[2, "Evidente retraso en el dialogo"],
		[3, "Dialogo difícil"],
		[4, "Torpeza absoluta"]
	],
	[
		[0, "Ninguna"],
		[1, "'Juega' con sus manos, cabellos, etc."],
		[2, "Se retuerce las manos, se muerde las uñas, se tira de los cabellos, se muerde los labios, etc."]
	],
	[
		[0, "No hay dificultad"],
		[1, "Tensión subjetiva e irritabilidad"],
		[2, "Preocupación por las pequeñas cosas"],
		[3, "Actitud aprensiva aparente en la expresión o el habla"],
		[4, "Temores expresados sin preguntarle"]
	],
	[
		[0, "Ausente"],
		[1, "Ligera"],
		[2, "Moderada"],
		[3, "Severa"],
		[4, "Incapacitante"]
	],
	[
		[0, "Ninguno"],
		[1, "Pérdida de apetito, pero come sin necesidad de que lo estimulen. Sensación de pesadez en el abdomen"],
		[2, "Dificultad de comer si no se le insiste. Solicita o necesita laxantes o medicación para sus síntomas gastrointestinales"]
	],
	[
		[0, "Ninguno"],
		[1, "Pesadez en extremidades, espalda o cabeza. Dorsalgías, cefalgías, algias musculares. Pérdida de energía y fatigabilidad."],
		[2, "Cualquier síntoma bien definido se clasifica en 2"]
	],
	[
		[0, "Ausente"],
		[1, "Débil"],
		[2, "Grave"]
	],
	[
		[0, "No la hay"],
		[1, "Preocupado de sí mismo (corporalmente)"],
		[2, "Preocupado por su salud"],
		[3, "Se lamenta constantemente. Solicita ayudas, etc."],
		[4, "Ideas delirantes hipocondríacas"]
	],
	[
		[0, "Según manifestaciones del paciente (primera valoración): No hay pérdida de peso"],
		[1, "Según manifestaciones del paciente (primera valoración): Probable pérdida de peso asociado con la enfermedad actual"],
		[2, "Según manifestaciones del paciente (primera valoración): Pérdida de peso definida (según el enfermo)"],
		[0, "Según pesaje hecho por el psiquiatra (valoraciones siguientes, expresadas por termino medio): Pérdida de peso inferior a 500 grs. en una semana"],
		[1, "Según pesaje hecho por el psiquiatra (valoraciones siguientes, expresadas por termino medio): Pérdida de más de 500 grs. en una semana"],
		[2, "Según pesaje hecho por el psiquiatra (valoraciones siguientes, expresadas por termino medio): Pérdida de más de 1 Kg en una semana"]
	],
	[
		[0, "Se da cuenta de que está deprimido y enfermo"],
		[1, "Se da cuenta de su enfermedad, pero atribuye la causa a una mala alimentación, clima, exceso de trabajo, virus, necesidad de descanso, etc."],
		[2, "Niega que esté enfermo"]
	],
	[
		[0, "Ausente"],
		[1, "Ligera (Mañana)"],
		[1, "Ligera (Tarde)"],
		[2, "Grave (Mañana)"],
		[2, "Grave (Tarde)"]
	],
	[
		[0, "Ausente"],
		[1, "Ligera. Como sensación de irrealidad"],
		[2, "Moderada. Ideas nihilistas"],
		[3, "Grave"],
		[4, "Incapacitante"]
	],
	[
		[0, "Ninguno"],
		[1, "Sospechosos"],
		[2, "Leves"],
		[3, "Ideas de referencia"],
		[4, "Delirios de referencia y de persecución"]
	],
	[
		[0, "Ausentes"],
		[1, "Ligeros"],
		[2, "Graves"]
	],
	[
		[0, "Ausentes"],
		[1, "Ligeros"],
		[2, "Graves"]
	]]
	for (i = 0; i<(opciones[num].length); i++){
		matemp = "<div class = 'opcion' onclick = anota(" +opciones[num][i][0]+ ")><p>" + opciones[num][i][1] + "</p></div>"
		respuestas = respuestas + matemp;
	}
	respuestas = respuestas + "</p></div>"

	var contenido = document.createElement('m6r');
	contenido.innerHTML = "<div class='m6r'><h2>"+ num + "</h2><div class='mbig'><br/>" + areas[num] + "</div><div class='mresps'>"+ respuestas +"</div><div class='clear'></div>";
	document.getElementById("matrices").appendChild(contenido);
	}


function comenzar(setM) {
	var nom=document.getElementById('inombre').value;
	var eda=document.getElementById('iedad').value;
	var sex=document.getElementById('isexo').value;
	loadedMatrix = 1;
	data = nom + "," + eda + "," + sex;
	$(articles).hide();
	$(header).hide();  
	matriz6r(loadedMatrix.toString());
	lastTimestamp = Math.round(+new Date());
	}
Array.prototype.stanDeviate = function(){
   var i,j,total = 0, mean = 0, diffSqredArr = [];
   for(i=0;i<this.length;i+=1){
       total+=this[i];
   }
   mean = total/this.length;
   for(j=0;j<this.length;j+=1){
       diffSqredArr.push(Math.pow((this[j]-mean),2));
   }
   return (Math.sqrt(diffSqredArr.reduce(function(firstEl, nextEl){
            return firstEl + nextEl;
          })/this.length));
};
function loadNext() {
	loadedMatrix++;
if (loadedMatrix < 23){
		if (type6.indexOf(selectedSet) != -1){  
		   	matriz6r(loadedMatrix.toString(), selectedSet);
		} else {
			matriz8r(loadedMatrix.toString(), selectedSet);
			}
		}
	else {
		pd = answ.reduce(sum, 0)
		sd = answ.stanDeviate()
		told = document.getElementById('informe').innerHTML
		t = "<h2>Puntuación</h2><p>Puntuación total: " + pd + "</p><p>Desviación típica: " + sd.toFixed(3) + "<p>"
		if (pd > 18){ t = t + "<b>Supera puntuación de corte 18</b>"} else {t = t + "No supera puntuación de corte"}
		t = t + "</p>"
		document.getElementById('informe').innerHTML = told + t
		$(informe).show();
		document.getElementById('csvp').innerHTML = data;
		}
	}
function sendMail() {
		var contenido = document.getElementById("csvp").innerHTML;
		var link = "mailto:jorgealonso@openmailbox.org"
		     + "?subject=" + escape("NEOFFI - " + document.getElementById("inombre").value)
		     + "&body=" + escape(contenido);

		window.location.href = link;
	}
</script>

</head>

<body>
	<div id="header">
		<h1>Escala de Hamilton para la Evaluación de la Depresión (HRSD)</h1>
		<div id="usuario">
			<div id="nombre"><label>Nombre:</label><input  class='opc' type="text" id="inombre" size="50"></div>
			<div id="edad"><label>Edad:</label><input  class='opc' type="text" id="iedad" size="3"></div>
			<div id="sexo"><label>Sexo:</label><select  class='opc' id="isexo">
						<option value="Hombre">Hombre</option>
						<option value="Mujer">Mujer</option>
					</select></div>
			<div id="fecha"><label>Fecha:</label><input  class='opc' type="text" id="ifecha" value="dd/mm/aaaa"></div>
			<script>
				var fecha = new Date()
				document.getElementById("ifecha").value = fecha.getDate() + "/" + (fecha.getMonth() +1) + "/" + fecha.getFullYear();

			</script>
		</div>
		<div class='clear'></div>
	</div>
	<div id='contenidos'>
		<div id="articles">
			<p>Esta escala ha sido durante los últimos años el instrumento clásico para evaluar la severidad de la depresión en el ámbito psiquiátrico y uno de los más utilizados en la investigación psicofarmacológica.</p>
			<p>Se centra básicamente en los componentes somáticos y comportamentales de la depresión.</p>
			<p>Debe de ser complementada al final de una entrevista semi-estructurada por un terapeuta entrenado, ya que los criterios de cada ítem están poco especificados, y no se diferencia entre intensidad y frecuencia de cada síntoma.</p>
			<p>La versión original fue realizada por Hamilton en 1960, y está formada por 21 ítems. Esta escala fue reducida posteriormente en 1967 por el mismo autor a 17 ítems, aunque la más utilizada sigue siendo la de 21 ítems.</p>
			<p>La versión que se presenta es la forma original de 21 ítems, más un ítem final para especificar otros síntomas.</p>
			<p><b>Instrucciones</b></p>
			<p>Los ítems son valorados con una puntuación de 0 a 2 en unos casos y de 0 a 4 en otros. La tarea del terapeuta consistirá en elegir, para cada ítem, la puntuación que mejor define las características del paciente.</p>
			<div class="opcion", onClick="comenzar('A')">
				<p>Comenzar</p>
			</div>
			<div class='clear'></div>
		</div>

		<div id="matrices">
		</div>
		<div id="informe">
			<h1>Escala de Hamilton para la Evaluación de la Depresión (HRSD)</h1>
			<h2>Resultados</h2>
			<div id='csvp' style="display: none;"></div>
			<p><a href="#" onclick="sendMail()">Enviar estos resultados!</a></p>
		</div>
	</div>
</body>

</html>
